# Асинхронный детектор ботов VK

**Это консольное приложение, которое позволяет обнаруживать ботов в социальной сети ВКонтакте** 
с помощью нейросетевых моделей. Для v1.0 точность предсказания составляет порядка **90%** как для 
реальных аккаунтов, так и для ботов. 

Позволяет анализировать около 120 000 - 150 000 аккаунтов за час с одного ключа VK API. 
Так же есть возможность параллельной работы: Если у вас найдется более одного ключа VK API и 
прокси к каждому из них, то и производительность программы вырастет в соответствии с 
количеством ключей.

## Возможности

Для быстрого сбора данных о пользователях используется библиотека aiohttp, которая позволяет делать 
асинхронные запросы к VK API.
> Для обнаружения ботов используются только данные о профиле, так как только для этого метода мне 
> не удалось обнаружить лимиты. Внутри программы есть методы для сбора групп и постов 
> пользователя, но на вход нейросети они не подаются... Может быть в будущем.

Есть возможность параллельной работы для более быстрого сбора информации. Для этого нужно указать 
дополнительные ключи VK API и дополнительные прокси на каждый ключ.

# Инструкция

## Быстрый запуск

Если нужно просто запустить программу, а разбираться что к чему - лень:

1. Скачать [архив с программой](https://github.com/NimalizTheFox/Async-bot-detector/releases/latest)
и распаковать его в удобное место. Сам архив весит ~150 Мб (v1.0), в распакованном виде ~650 Мб

2. Подготовить `.xlsx` или `.txt` файл с id нуждающихся в проверке профилей (**именно ID,
а не screen_name**). 

    > В `.txt` профили можно указывать id-шником - _id123456_ или просто цифрами - _123456_, другие 
    варианты будут игнорироваться.
    > 
    > В `.xlsx` можно использовать ссылки вида _[https://vk.com/id123456]()_, сам id - 
    > _id123456_ или просто цифры - _123456_ 
    >
    > **Будут анализироваться только профили, без групп (_club123456_)!**  

3. Запустить командную строку (_Win+R_ и написать _cmd_) и перейти в распакованную папку программы
    ```commandline
    cd path/to/bot_detector
    ```

4. Внести в приложение токен VK API, который нужно получить от моего приложения по ссылке - https://oauth.vk.com/authorize?client_id=51458258&redirect_uri=https://oauth.vk.com/blank.html&display=page&scope=offline,wall,photos,friends,groups&response_type=token&v=5.199 

    Нужно перейти по ссылке, после чего скопировать из адресной строки текст, 
от `vk1.a.` и до `&` (без этого символа). Это и есть токен.

    > Я использую приложение, так как с помощью него можно создавать хранимые процедуры, 
   > которые позволяют обрабатывать по 25 профилей на сервере VK за 1 запрос от приложения, 
   > что существенно ускоряет сбор данных.

    После чего внести токен в приложение с помощью следующей команды:
    ```commandline
    bot_detector token new -t СКОПИРОВАННЫЙ_ТОКЕН
    ```

5. Прописать команду для старта анализа 
    
    - **Если у вас профили в .xlsx файле:**
    ```commandline
    bot_detector analyse ПУТЬ_ДО_ВАШЕГО_ФАЙЛА.xslx -s -t -c ИНДЕКС_СТОЛБЦА_С_id
    ```
   > **Индекс столбца считается с 0**, то есть, если ваши id лежат в столбце **A**, 
   > то нужно вписать **0**, если в **B**, то **1** и так далее.
   > 
   > Если колонок с id несколько, то нужно прописать их индексы через запятую и без пробелов
   > (например `1,2,3`).
   > 
   > **Есть у вас в файле есть заголовки**, то нужно дополнительно прописать флаг `-t`. 
   > Тогда программа пропустит первую строку в файле. Если заголовков нет, то и флаг `-t` писать не нужно
   
    - **Если у вас профили в .txt файле:**
    ```commandline
    bot_detector analyse ПУТЬ_ДО_ВАШЕГО_ФАЙЛА.txt -s
    ```

6. Дождаться окончания работы программы
7. Посмотреть в папку с входным файлом, там будут файлы с таким же названием, но с припиской _**Прогноз**_, 
где находятся вероятности того, что профиль является ботом, и _**Статистика**_, где находится статистика по
всем обнаруженным в файле профилям постранично.

**Готово!**


## Подробнее обо всем

Все команды можно узнать через флаг `-h`

```cmd
bot_detector -h

bot_detector analyse -h

bot_detector token -h

bot_detector proxy -h
```

### Токены

_**Без хотя бы одного токена приложение не запустится!**_

У токенов есть несколько подкоманд:
- `new` - добавить токен
- `delete` - удалить токен 
- `show` - вывести список всех токенов

> По каждой из них тоже есть справка, которую можно вывести с помощью `-h`

При добавлении (`new`) и удалении (`delete`) токена нужно указать обязательный флаг `-t`, после 
которого вставить нужный для добавления или удаления токен VK API.
```commandline
bot_detector token new -t ВАШ_ТОКЕН
```

Для показа (`show`) никаких дополнительных флагов не предусмотренно, он просто выводит список токенов.
```commandline
bot_detector token show
```

### Прокси

_**Да здравствует параллельность!**_

Если вы решили использовать параллельный сбор информации, то необходимо воспользоваться прокси. 
По-хорошему должно быть соотношение _1 токен = 1 прокси_, если его не соблюдать, то количество 
параллельных процессов будет `min(токены, прокси)`.
> Если используется только один токен, то прокси можно проигнорировать, так как можно использовать 
> адрес оригинальной машины.

Как и у токенов, у прокси есть несколько подкоманд:
- `new` - добавить прокси
- `delete` - удалить прокси 
- `show` - вывести список всех прокси

> По каждой из них тоже есть справка, которую можно вывести с помощью `-h`

При добавлении нового прокси (`new`) необходимо указать обязательный флаг `-a`, после которого 
написать адрес прокси, и два необязательных флага `-l` (`--login`) и `-p` (`--password`),
которые нужны для авторизации прокси.
```commandline
bot_detector proxy new -a АДРЕС_ПРОКСИ -l ЛОГИН -p ПАРОЛЬ
```

При удалении прокси нужно будет указать только его адрес (`-a`).
```commandline
bot_detector proxy delete -a АДРЕС_ПРОКСИ
```

Для показа всех прокси флаги не нужны:
```commandline
bot_detector proxy show
```

### Анализ

_**Самое сердце программы, здесь происходит вся магия!**_

У анализа подкоманд нет, только флаги.

```commandline
bot_detector analyse -h
```

Чтобы заставить программу работать, нужно дать ей входной `.xlsx` или `.txt` файл, в котором 
будут ID профилей. Если это `.xslx` файл, то обязательно необходимо указать флаг `-с`, 
в котором нужно указать индекс колонки с ID (нумерация с 0), если таких колонок несколько,
то указывать через запятую, без пробела: `0,1,2`.

Так же, если это `.xlsx` файл и у него первой строкой идут **заголовки столбцов**, то необходимо 
указать флаг `-t`, который пропустит первую строку таблицы.

Если вы хотите поместить результаты куда-то еще, а не в папку ко входному файлу, то нужно 
указать выходную папку через флаг `-o`.

Если в дополнение к прогнозам в отношении ботов вы хотите получить еще и **статистику** 
по страницам, то пропишите флаг `-s`, который добавит текстовый файл со всей статистикой
по входному файлу.

Сами выходные данные будут в `.xlsx` файле, при этом будет **сохранена структура оригинального 
`.xlsx` файла**, то есть будут точно такие же листы и все id будут на точно том же месте, 
где их и забрали (если не считать заголовки)
```commandline
bot_detector analyse 
    ПУТЬ_ДО_ВАШЕГО_.xslx_ФАЙЛА 
    -o ПУТЬ_К_ВЫХОДНОЙ_ПАПКЕ
    -s
    -t 
    -c ИНДЕКС_СТОЛБЦА_С_id 
```

# Успехов :)
